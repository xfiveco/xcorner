<div data-cart-quantity="{{cart.quantity}}">
    <div>
        <div>{{lang 'cart.checkout.item'}}</div>
        <div>{{lang 'cart.checkout.price'}}</div>
        <div>{{lang 'cart.checkout.quantity'}}</div>
        <div>{{lang 'cart.checkout.total'}}</div>
    </div>
    <div>
        {{#each cart.items}}
            <div class="js-item-row">
                <div>
                    {{#if type '==' 'GiftCertificate'}}
                        <img
                            src="{{cdn ../theme_settings.default_image_gift_certificate}}"
                            alt="{{lang 'cart.gift_certificates.gift_certificate'}}"
                            title="{{lang 'cart.gift_certificates.gift_certificate'}}"
                        >
                    {{else}}
                        {{> components/common/image
                            image=image
                            fallback_size=../theme_settings.productthumb_size
                            default_image=../theme_settings.default_image_product
                        }}
                    {{/if}}
                </div>
                <div>
                    {{#if brand.name}}
                        <p>{{brand.name}}</p>
                    {{/if}}
                    <div>
                        <a href="{{url}}">
                            {{name}}
                        </a>
                    </div>
                    {{#if release_date}}
                        <p>({{release_date}})</p>
                    {{/if}}

                    {{#if options}}
                        <dl>
                            {{#each options}}
                                <dt>{{name}}:</dt>
                                <dd>
                                    {{#if is_file}}
                                        <a href="/viewfile.php?attributeId={{id}}&cartitem={{../id}}">
                                            {{value}}
                                        </a>
                                    {{else}}
                                        {{> components/common/product-options}}
                                    {{/if}}
                                </dd>
                            {{/each}}
                        </dl>

                        <a 
                            href="#"
                            data-item-edit="{{id}}"
                            data-product-id="{{product_id}}"
                            aria-label="{{lang 'products.change_product_options' name=name}}"
                        >
                            {{lang 'common.change'}}
                        </a>
                    {{/if}}

                    {{#if type '==' 'GiftCertificate'}}
                        <a 
                            href="{{edit_url}}"
                            aria-label="{{lang 'cart.gift_certificates.change_gift_certificate' certificate_name=name}}"
                        >
                            {{lang 'common.change'}}
                        </a>
                    {{/if}}

                    {{> components/cart/item-giftwrap this}}
                    
                    {{#if event_date}}
                        <dl>
                            <dt>
                                {{event_date.name}}
                            </dt>
                            <dd>
                                {{event_date.date}}
                            </dd>
                        </dl>
                    {{/if}}
                </div>

                <div>
                    <span>{{lang 'cart.checkout.price'}}</span>
                    
                    {{#or ../customer (unless ../settings.hide_price_from_guests) (if type '==' 'GiftCertificate')}}
                        <span class="{{#if price_discounted}}price-discounted{{/if}}">
                            {{price.formatted}}
                        </span>
                        
                        {{#if price_discounted}}
                            <span>
                                {{price_discounted.formatted}}
                            </span>
                        {{/if}}
                    {{else}}
                        {{> components/common/login-for-pricing}}
                    {{/or}}
                </div>

                <div>
                    <label for="qty-{{id}}">
                        {{lang 'products.quantity'}}
                    </label>
                    
                    <div class="form-increment">
                        {{#if can_modify}}
                            <button class="c-button button--icon"
                                    data-cart-update
                                    data-cart-itemid="{{id}}"
                                    data-action="dec"
                            >
                                <span class="is-srOnly">{{lang 'products.quantity_decrease' name=name}}</span>
                                <i class="icon" aria-hidden="true"><svg><use href="#icon-keyboard-arrow-down" /></svg></i>
                            </button>
                        {{/if}}
                        <input class="js-form-input js-form-input-increment-total cart-item-qty-input"
                               id="qty-{{id}}"
                               name="qty-{{id}}"
                               type="tel"
                               value="{{quantity}}"
                               data-quantity-min="{{min_purchase_quantity}}"
                               data-quantity-max="{{max_purchase_quantity}}"
                               data-quantity-min-error="{{lang 'products.quantity_min' quantity=min_purchase_quantity}}"
                               data-quantity-max-error="{{lang 'products.quantity_max' quantity=max_purchase_quantity}}"
                               min="1"
                               pattern="[0-9]*"
                               data-cart-itemid="{{id}}"
                               data-action="manualQtyChange"
                               aria-label="{{name}}"
                               aria-live="polite"{{#unless can_modify}} disabled{{/unless}}>
                        {{#if can_modify}}
                            <button class="c-button button--icon"
                                    data-cart-update
                                    data-cart-itemid="{{id}}"
                                    data-action="inc"
                            >
                                <span class="is-srOnly">{{lang 'products.quantity_increase' name=name}}</span>
                                <i class="icon" aria-hidden="true"><svg><use href="#icon-keyboard-arrow-up" /></svg></i>
                            </button>
                        {{/if}}
                    </div>

                </td>

                <td class="cart-item-block cart-item-info">
                    <span class="cart-item-label">{{lang 'cart.checkout.total'}}</span>
                    {{#or ../customer (unless ../settings.hide_price_from_guests) (if type '==' 'GiftCertificate')}}
                        <strong class="cart-item-value {{#if total_discounted}}price--discounted{{/if}}">{{total.formatted}}</strong>
                        {{#if total_discounted}}
                            <strong class="cart-item-value">{{total_discounted.formatted}}</strong>
                        {{/if}}
                    {{else}}
                        --
                    {{/or}}
                    {{#or can_modify (if type '==' 'GiftCertificate')}}
                        <button class="cart-remove icon"
                                data-cart-itemid="{{id}}"
                                data-confirm-delete="{{lang 'cart.confirm_delete'}}"
                                aria-label="{{lang 'cart.remove_item' name=name}}"
                        >
                            <svg><use href="#icon-close"></use></svg>
                        </button>
                    {{/or}}
                </td>
            </div>
        {{/each}}
    </div>
</div>
